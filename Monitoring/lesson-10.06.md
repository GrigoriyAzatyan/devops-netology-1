# 10.06. Инцидент-менеджмент

|Краткое описание инцидента|В 22:52 21.10.2018 на нескольких сервисах GitHub.com пострадали несколько сетевых разделов и последующим сбоем базы данных. В результате возникла несогласованность данных и  деградация сервиса в течении 24 часов и 11 минут.|
|--------------------------|-|
|Предшествующие события|Потеря соединения на 100Гб оптическом канале связи между US East Coast network hub и US East Coast data center.|
|----------------------|-|
|Причина инцидента|Кратковременная потеря соединения network hub`a и основного data center.|
|-----------------|-|
|Воздействие|Несогласованность предоставляемой информации (отображение не актуальной информации). Принудительное отключение WebHook.|
|-----------|-|
|Обнаружение|Обнаружено инженерами обрабтывающими алерты монторинга.|
|-----------|-|
|Реакция|Деградаия сервиса в теении 24 часов и 11 минут.|
|-------|-|
|Восстановление|Восстановление полной производительности было выполнено за счет восстановления данных из бэкаповх и повторных репликаций всех имеющихся данных с хостов с актуальными данными.|
|--------------|-|
|Таймлайн| 21.10.2018 22:52 Серверы баз данных в центре обработки данных на восточном побережье США содержали короткий период записи, который не был реплицирован на западном побережье США, поэтому кластеры баз данных в обоих центрах обработки данных теперь содержали записи, отсутствовавшие в другом центре обработки данных.
21.10.2018 22:54 Несколько инженеров поддержки начали работу с поступающими предупреждения от системы мониторинга. 
21.10.2018 23:02 Инженерам удалось определить, что нессответствие статуса кластеров баз данных. Запросы репликации БД показывал только западное побереже США.
21.10.2018 23:07 Отключен внутренние инструменны развертывания для предотвращения дальнейших имзменй. 
21.10.2018 23:09 Ответственная команда переводит сайт в "желтый статус", что автоматически переводит текущую ситуацию в статус инцидента и отправляет оповещения ответственным за инциденты.
21.10.2018 23:11 К расследованию присодиняется координатор инцидента.
21.10.2018 23:13 Координатор инцидента переводит статус на "красный". Привлеченый инженеры группы разработки баз данных, которые начали прорабатывать варианты ручной настройки бд. Приняты меры по сохранению и защите данных пользователей.
21.10.2018 23:19 Принято решение остановить часть сервисов, таких как push уведомления и github pages, ради сохранения целостности данных пользователей.
22.10.2018 00:05 Обновлен статус, чтобы проинформировать пользователей о запланированном переходе на другой внутренний ресурс. Приянто решение восстанавливать данные из резервных копий кластера. Начат перенос резервных копий из удаленных хранилищь.
22.10.2018 00:41 Инициирован процесс резервного копирования.
22.10.2018 06:51 Несколько кластеров закончили восстановление и начали репликацию с восточного побережья США. 
22.10.2018 07:46 Публикация сообщения в блоге, для оповещения пользователей.
22.10.2018 11:12 Все БД закончили восстановление, но по прежнему существовало большое кол-во реплик, с несогласованными данными.
22.10.2018 13:15 Группа реагирования на инциденты приняла решение предоставить дополнительные реплики MySQL в облаке восточного побережья.
22.10.2018 16:24 Все реплики синхронизированы. Выполнено переключение на исходную топологию.
22.10.2018 23:03 Подтверждение корректности работы всех сервисов. Смена статуса на "зеленый".
|--------|-|
|Последующие действия|Собранны логи по всем серверам подвергнутых сбою, производится анализ логов для выявления запросов которые требуется обработать в ручну и информировать пользователей о возможных проблемах.|
|--------------------|-|
|Корректирующие действия| Настройка конфигурациии Оркестратора для снижения рисков поведения вызвавшего инцидент.
Составление новой системы статусов, для более четкого отображения работоспособности отдельных компонентов платформы.
Введение практики проверки сценариев сбоев.

